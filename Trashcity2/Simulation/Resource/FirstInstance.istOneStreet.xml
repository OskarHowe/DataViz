<?xml version="1.0" encoding="UTF-8"?>
<!--
  Language: XML
  $Author:$
  $Date:$
  $Revision$
  $Copyright: [2010-2017] Cosmo Tech, All Rights Reserved $
-->
<csm:Model xmlns:doc="http://www.cosmotech.com/csm_doc/8.8"
  xmlns:dbk="http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd"
  xmlns:csm="http://www.cosmotech.com/csm/8.8">
  <csm:Scheduler>
    <csm:RunTask>
      <csm:Entity>1</csm:Entity>
    </csm:RunTask>
  </csm:Scheduler>
  <csm:City id="1" name="Lyon">
    <csm:Compound>
      <csm:SubEntities>
        <Street id="2" name="Avenue">
          <csm:Compound>
            <csm:SubEntities>
              <csm:Inhabitant id="4" name="Paul"/>
              <csm:Inhabitant id="5" name="Tom"/>
              <csm:Inhabitant id="6" name="Ame"/>
              <csm:Truck id="7" name="Truck1"/>
              <csm:Truck id="8" name="Truck2"/>
            </csm:SubEntities>
            <csm:Environment>
              <csm:Vertex>4</csm:Vertex>
              <csm:Vertex>5</csm:Vertex>
              <csm:Vertex>6</csm:Vertex>
              <csm:Vertex>7</csm:Vertex>
              <csm:Vertex>8</csm:Vertex>
              <csm:Edge>
                <csm:Left>4</csm:Left>
                <csm:Right>7</csm:Right>
              </csm:Edge>
              <csm:Edge>
                <csm:Left>4</csm:Left>
                <csm:Right>8</csm:Right>
              </csm:Edge>
              <csm:Edge>
                <csm:Left>6</csm:Left>
                <csm:Right>7</csm:Right>
              </csm:Edge>
              <csm:Edge>
                <csm:Left>6</csm:Left>
                <csm:Right>8</csm:Right>
              </csm:Edge>
              <csm:Edge>
                <csm:Left>5</csm:Left>
                <csm:Right>8</csm:Right>
              </csm:Edge>
              <csm:Edge>
                <csm:Left>5</csm:Left>
                <csm:Right>7</csm:Right>
              </csm:Edge>
              <csm:Edge>
                <csm:Left>5</csm:Left>
                <csm:Right>6</csm:Right>
              </csm:Edge>
              <csm:Edge>
                <csm:Left>6</csm:Left>
                <csm:Right>4</csm:Right>
              </csm:Edge>
              <csm:Edge>
                <csm:Left>4</csm:Left>
                <csm:Right>5</csm:Right>
              </csm:Edge>
            </csm:Environment>
          </csm:Compound>
          <csm:Scheduler>
            <csm:RepeatTaskBlock repetitions="7">
              <csm:SequentialTaskBlock>
                <csm:ForEachTask>
                  <csm:ModelName>Model</csm:ModelName>
                  <csm:Entity>City</csm:Entity>
                  <csm:SubEntityType>Inhabitant</csm:SubEntityType>
                  <csm:Process>ProduceTrash</csm:Process>
                </csm:ForEachTask>
                <csm:ForEachTask>
                  <csm:ModelName>Model</csm:ModelName>
                  <csm:Entity>City</csm:Entity>
                  <csm:SubEntityType>Inhabitant</csm:SubEntityType>
                  <csm:Process>UpdateSatisfaction</csm:Process>
                </csm:ForEachTask>
              </csm:SequentialTaskBlock>
              <csm:ParallelTaskBlock concurrencyLevel="1">
                <csm:ParallelTask>
                  <csm:Entity>4</csm:Entity>
                </csm:ParallelTask>
                <csm:ParallelTask>
                  <csm:Entity>5</csm:Entity>
                </csm:ParallelTask>
                <csm:ParallelTask>
                  <csm:Entity>6</csm:Entity>
                </csm:ParallelTask>
              </csm:ParallelTaskBlock>
            </csm:RepeatTaskBlock>
            <csm:SequentialTaskBlock>
              <csm:ForEachTask>
                <csm:ModelName>Model</csm:ModelName>
                <csm:Entity>City</csm:Entity>
                <csm:SubEntityType>Truck</csm:SubEntityType>
                <csm:Process>CalcCost</csm:Process>
              </csm:ForEachTask>
              <csm:ForEachTask>
                <csm:ModelName>Model</csm:ModelName>
                <csm:Entity>City</csm:Entity>
                <csm:SubEntityType>Truck</csm:SubEntityType>
                <csm:Rule>PickupTrash</csm:Rule>
              </csm:ForEachTask>
              <csm:ForEachTask>
                <csm:ModelName>Model</csm:ModelName>
                <csm:Entity>City</csm:Entity>
                <csm:SubEntityType>Truck</csm:SubEntityType>
                <csm:Process>EmptyLoad</csm:Process>
              </csm:ForEachTask>
            </csm:SequentialTaskBlock>
          </csm:Scheduler>
        </Street>
      </csm:SubEntities>
      <csm:Environment/>
    </csm:Compound>
    <csm:Scheduler>
      <csm:ForEachTask>
        <csm:ModelName>Model</csm:ModelName>
        <csm:Entity>City</csm:Entity>
        <csm:SubEntityType>Street</csm:SubEntityType>
        <csm:MesoFunction>OverviewStreet</csm:MesoFunction>
      </csm:ForEachTask>
      <csm:ForEachTask>
        <csm:ModelName>Model</csm:ModelName>
        <csm:Entity>City</csm:Entity>
        <csm:SubEntityType>Street</csm:SubEntityType>
        <csm:Process>CalcTrucksNeededAndActivate</csm:Process>
      </csm:ForEachTask>
      <!--
          foreach i (
            <csm:RunTask>
            <csm:Entity>i</csm:Entity>
            </csm:RunTask>
          )
        -->
      <csm:RunTask>
        <csm:Entity>2</csm:Entity>
      </csm:RunTask>
      <csm:ForEachTask>
        <csm:ModelName>Model</csm:ModelName>
        <csm:Entity>City</csm:Entity>
        <csm:SubEntityType>Street</csm:SubEntityType>
        <csm:MesoFunction>OverviewStreet</csm:MesoFunction>
      </csm:ForEachTask>
      <csm:ForEachTask>
        <csm:ModelName>Model</csm:ModelName>
        <csm:Entity>City</csm:Entity>
        <csm:SubEntityType>Street</csm:SubEntityType>
        <csm:Process>CalcTruckCostTotal</csm:Process>
      </csm:ForEachTask>
      <csm:ForEachTask>
        <csm:ModelName>Model</csm:ModelName>
        <csm:Entity>City</csm:Entity>
        <csm:SubEntityType>Street</csm:SubEntityType>
        <csm:Process>CalManif</csm:Process>
      </csm:ForEachTask>
    </csm:Scheduler>
  </csm:City>
</csm:Model>
